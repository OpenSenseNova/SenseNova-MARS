# Official Tool Configuration with Search for Validation
#
# This config includes all 3 tools for datasets requiring search:
# - image_zoom_in_tool: Zoom/crop image regions
# - text_search_tool: Web search for text information (uses Google Serper for validation)
# - image_search_tool: Reverse image search
#
# Usage:
#   actor_rollout_ref.rollout.multi_turn.val_tool_config_path="path/to/tools_official_with_search_val.yaml"

tools:
  # Image Zoom In Tool
  # Uses relative coordinates (0-1000) for bbox_2d
  - class_name: verl.tools.image_zoom_in_tool.ImageZoomInTool
    config:
      type: native
      # Coordinate mode: "relative" or "absolute"
      image_crop_mode: relative
      # Max value for relative coordinates (1000 for Qwen2-VL style)
      relative_coord_max: 1000.0
      # No padding for zoom (exact crop)
      padding: [0.0, 0.0]
      # Use smart_resize for output alignment (factor=28)
      use_smart_resize: true
    tool_schema:
      type: function
      function:
        name: image_zoom_in_tool
        description: "Zoom in on a specific region of an image by cropping it based on a bounding box (bbox) and an optional object label"
        parameters:
          type: object
          properties:
            bbox_2d:
              type: array
              items:
                type: number
              minItems: 4
              maxItems: 4
              description: "The bounding box of the region to zoom in, as [x1, y1, x2, y2], where (x1, y1) is the top-left corner and (x2, y2) is the bottom-right corner"
            label:
              type: string
              description: "The name or label of the object in the specified bounding box"
            img_idx:
              type: number
              description: "The index of the zoomed-in image (starting from 0)"
          required:
            - bbox_2d
            - label
            - img_idx

  # Text Search Tool - uses google_serper for validation (real-time search)
  - class_name: verl.tools.text_search_tool.TextSearchTool
    config:
      type: native
      text_search_type: google_serper
      text_search_address: ${oc.env:TEXT_SEARCH_ADDRESS}
      local_database_address: ${oc.env:LOCAL_DATABASE_ADDRESS}
      text_search_topk: 3
      text_search_llm_model: "qwen3-32b"
      text_search_prompt_type: "mmsearch_r1"
      text_search_use_jina: false
      text_search_enable_thinking: false
      max_concurrent: 4
      timeout: 300
      max_attempts: 3
    tool_schema:
      type: function
      function:
        name: text_search_tool
        description: "Search the web for text information related to your query. Use this when you need to find facts, news, or information."
        parameters:
          type: object
          properties:
            query:
              type: string
              description: "The search query to find relevant information"
          required:
            - query

  # Image Search Tool - data-driven reverse image search
  - class_name: verl.tools.image_search_tool.ImageSearchTool
    config:
      type: native
      tcs_conf_path: "~/aoss.conf"
      use_image_search_summary: false
    tool_schema:
      type: function
      function:
        name: image_search_tool
        description: "Perform a reverse image search to find similar images and related information. This can help identify objects, places, or find more context about the image."
        parameters:
          type: object
          properties: {}
          required: []
